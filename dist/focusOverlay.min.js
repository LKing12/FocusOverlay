/*! ________________ 
*   ___  ____/_  __ \
*   __  /_   _  / / /
*   _  __/   / /_/ / 
*   /_/      \____/  
*   Focus Overlay
* 
*  Version: 0.9.0
*  Author: Maurice Mahan
*  License: MIT
*  Repo: https://github.com/MauriceMahan/FocusOverlay
*/
!function(e){"function"==typeof define&&define.amd?define(["jquery"],function(t){return e(t,window)}):"object"==typeof module&&module.exports?module.exports=function(t,o){return void 0===o&&(o="undefined"!=typeof window?require("jquery"):require("jquery")(t)),e(o,window),o}:e(jQuery,window)}(function(e,t){function o(t,o){var n=this;n.active=!1,n.$el=e(t),n.$focusBox=e("<div aria-hidden='true' />"),n.$previousTarget,n.$nextTarget,n.timeout=0,n.options=e.extend({},e.fn.focusOverlay.defaults,o),n.onFocusHandler=e.proxy(n.onFocusHandler,n),n.createFocusBox=e.proxy(n.createFocusBox,n),n.onKeyDownHandler=e.proxy(n.onKeyDownHandler,n),n.moveFocusBox=e.proxy(n.moveFocusBox,n),n.cleanup=e.proxy(n.cleanup,n),n.stop=e.proxy(n.stop,n),n.destroy=e.proxy(n.destroy,n),n.init()}o.prototype={init:function(){var e=this;e.options.alwaysActive?(e.active=!0,t.addEventListener("focus",e.onFocusHandler,!0)):(t.addEventListener("keydown",e.onKeyDownHandler,!1),e.options.inactiveOnClick&&t.addEventListener("mousedown",e.stop,!1)),e.createFocusBox(),e.$el.trigger("foInit",[e])},onKeyDownHandler:function(o){var n=this,i=o.which;e.inArray(i,n.options.triggerKeys)>=0?!1===n.active&&(n.active=!0,t.addEventListener("focus",n.onFocusHandler,!0)):n.options.inactiveOnNonTriggerKey&&n.stop()},createFocusBox:function(){var e=this;e.$focusBox.appendTo(e.$el).attr("id",e.options.id).css({position:"absolute",zIndex:e.options.zIndex,pointerEvents:"none"})},cleanup:function(){var e=this;null!=e.$nextTarget&&(e.$previousTarget=e.$nextTarget,e.$previousTarget.removeClass(e.options.targetClass))},onFocusHandler:function(t){var o=this,n=o.$nextTarget,i=e(t.target),r=o.$previousTarget;if(o.cleanup(),i.data("focus"))o.$nextTarget=e(i.data("focus")).first();else if(i.is("[data-focus-label]"))o.$nextTarget=e("[for='"+i.attr("id")+"']");else{if(i.is("[data-focus-ignore]"))return;o.$nextTarget=i}clearTimeout(o.timeout),o.$el.trigger("foBeforeMove",[o,r,n,o.$nextTarget]),o.moveFocusBox(o.$nextTarget)},stop:function(){var e=this;e.active=!1,t.removeEventListener("focus",e.onFocusHandler,!0),e.cleanup(),e.$focusBox.removeClass(e.options.activeClass)},moveFocusBox:function(e){var t=this;if(e.addClass(t.options.targetClass),e.length>0&&e[0]instanceof Element){var o=t._getAbsoluteBoundingRect(e[0]),n=o.width,i=o.height,r=o.left,s=o.top;t.$focusBox.addClass(t.options.animatingClass).addClass(t.options.activeClass).css({width:n,height:i,left:r,top:s}),t.timeout=setTimeout(function(){t.$focusBox.removeClass(t.options.animatingClass),t.options.inactiveAfterDuration&&t.$focusBox.removeClass(t.options.activeClass),t.$el.trigger("foAfterMove",[t,t.$previousTarget,e])},t.options.duration)}else t.cleanup()},destroy:function(){var e=this;e.$el.removeData(),e.$focusBox.remove(),null!=e.$previousTarget&&e.$previousTarget.removeClass(e.options.targetClass),null!=e.$nextTarget&&e.$nextTarget.removeClass(e.options.targetClass),t.removeEventListener("focus",e.onFocusHandler,!0),t.removeEventListener("keydown",e.onKeyDownHandler,!1),t.removeEventListener("mousedown",e.stop,!1),e.$el.trigger("foDestroyed",[e])},_getAbsoluteBoundingRect:function(e){var o=document,n=t,i=o.body,r=void 0!==n.pageXOffset?n.pageXOffset:(o.documentElement||i.parentNode||i).scrollLeft,s=void 0!==n.pageYOffset?n.pageYOffset:(o.documentElement||i.parentNode||i).scrollTop,a=e.getBoundingClientRect();if(e!==i)for(var u=e.parentNode;u!==i&&u;)r+=u.scrollLeft,s+=u.scrollTop,u=u.parentNode;return{bottom:a.bottom+s,height:a.height,left:a.left+r,right:a.right+r,top:a.top+s,width:a.width}}},e.fn.focusOverlay=function(t){var n=arguments;if(void 0===t||"object"==typeof t)return this.each(function(){e.data(this,"plugin_"+o)||e.data(this,"plugin_"+o,new o(this,t))});if("string"==typeof t&&"_"!==t[0]&&"init"!==t){if(0==Array.prototype.slice.call(n,1).length&&-1!=e.inArray(t,e.fn.focusOverlay.getters)){var i=e.data(this[0],"plugin_"+o);return i[t].apply(i,Array.prototype.slice.call(n,1))}return this.each(function(){var i=e.data(this,"plugin_"+o);i instanceof o&&"function"==typeof i[t]&&i[t].apply(i,Array.prototype.slice.call(n,1))})}},e.fn.focusOverlay.getters=["destroy"],e.fn.focusOverlay.defaults={id:"focus-overlay",activeClass:"focus-overlay-active",animatingClass:"focus-overlay-animating",targetClass:"focus-overlay-target",zIndex:9001,duration:500,inactiveAfterDuration:!1,triggerKeys:[9,36,37,38,39,40,13,32,16,17,18,27],inactiveOnNonTriggerKey:!0,inactiveOnClick:!0,alwaysActive:!1}});